# üõ°Ô∏è OpenVAS - Vulnerability Assessment Scanner

Comprehensive guide to using OpenVAS (Open Vulnerability Assessment Scanner) for network and web vulnerability scanning.

**Location in Framework:** `web-pentesting/vulnerability-assessment/openvas.md`

---

## üéØ What is OpenVAS?

OpenVAS is a comprehensive vulnerability scanner and management platform that provides:
- **Network vulnerability scanning** across multiple protocols
- **Web application security testing** capabilities  
- **Configuration assessment** for various systems
- **Compliance checking** against security standards
- **Detailed reporting** with risk prioritization
- **Centralized management** through web interface

---

## üì¶ Installation and Setup

### Kali Linux Installation
```bash
# Install OpenVAS components
apt-get update
apt-get install openvas

# Alternative: Install from official repositories
apt-get install gvm
```

### Initial Setup and Configuration
```bash
# Setup OpenVAS databases and users
gvm-setup

# Check installation status
gvm-check-setup

# Start OpenVAS services
gvm-start

# Stop OpenVAS services (when needed)
gvm-stop
```

### Web Interface Access
```bash
# Default web interface
https://localhost:9392

# Default credentials (change immediately)
Username: admin
Password: [generated during setup - check gvm-setup output]

# Create new admin user
gvm-manage-certs -a
```

---

## üîß Web Interface Navigation

### Main Dashboard Components
- **Tasks** - Scan configuration and execution
- **Results** - Scan findings and reports
- **Assets** - Target management and inventory
- **SecInfo** - Vulnerability feeds and information
- **Configuration** - Scanner settings and management

### Task Management
```
1. Navigate to Scans ‚Üí Tasks
2. Click "Create New Task"
3. Configure scan parameters:
   - Name and comment
   - Scan config (Full and fast, etc.)
   - Target definition
   - Schedule (optional)
4. Start scan immediately or schedule
```

---

## üéØ Target Configuration

### Creating Target Lists
```
Assets ‚Üí Hosts ‚Üí New Host
- Name: Target description
- Hosts: IP addresses or ranges
- Exclude hosts: Exceptions
- Port range: Specific ports to scan
- Credentials: Authentication info
```

### Target Specification Examples
```bash
# Single host
192.168.1.100

# Multiple hosts
192.168.1.100,192.168.1.101,192.168.1.102

# IP range
192.168.1.100-110

# CIDR notation
192.168.1.0/24

# Hostname
target.example.com

# Exclude hosts
192.168.1.0/24 exclude:192.168.1.1,192.168.1.5
```

### Credential Configuration
```
Configuration ‚Üí Credentials ‚Üí New Credential

Types supported:
- Username/Password (SSH, SMB, etc.)
- SSH Key authentication  
- SNMP community strings
- Database credentials
- Certificate-based authentication
```

---

## ‚öôÔ∏è Scan Configurations

### Predefined Scan Configs
| Config Name | Description | Use Case |
|-------------|-------------|----------|
| **Full and fast** | Comprehensive scan | Complete assessment |
| **Full and fast ultimate** | Most thorough scan | Critical systems |
| **Discovery** | Host discovery only | Network mapping |
| **Host Discovery** | Live host identification | Reconnaissance |
| **System Discovery** | Basic system info | Initial assessment |

### Custom Scan Configuration
```
Configuration ‚Üí Scan Configs ‚Üí New Scan Config

Customizable options:
- Network Vulnerability Tests (NVTs) selection
- Port scanner preferences  
- Timing and performance settings
- Credential usage configuration
- Report format preferences
```

### Performance Optimization
```
Scanner Preferences:
- Max concurrent NVTs: 4-10 (based on network capacity)
- Max concurrent hosts: 20-50 (based on target network)
- Network timeout: 5-30 seconds
- Scanner timeout: 300-3600 seconds
```

---

## üöÄ Running Scans

### Quick Scan Setup
```
1. Go to Scans ‚Üí Tasks
2. Click "Task Wizard"
3. Enter target IP or range
4. Select scan configuration
5. Click "Create and Start"
```

### Advanced Scan Configuration
```
Task Configuration:
- Name: Descriptive task name
- Comment: Scan purpose and scope
- Scan Config: Appropriate configuration
- Target: Predefined target list
- Scanner: Default OpenVAS Scanner
- Schedule: Immediate or scheduled
- Alerts: Notification settings
```

### Monitoring Scan Progress
```
Dashboard indicators:
- Task status (Running, Done, Stopped)
- Progress percentage
- Current activity description
- Time elapsed and estimated completion
- Resource utilization metrics
```

---

## üìä Results Analysis

### Scan Results Overview
```
Results ‚Üí Reports ‚Üí [Scan Name]

Key metrics displayed:
- Severity distribution (Critical, High, Medium, Low, Log)
- Host status summary
- Vulnerability count per host
- Compliance status (if applicable)
- Scan duration and statistics
```

### Vulnerability Severity Levels
| Severity | Score Range | Description | Action Required |
|----------|-------------|-------------|-----------------|
| **Critical** | 9.0 - 10.0 | Immediate threat | Fix immediately |
| **High** | 7.0 - 8.9 | Significant risk | Fix within days |
| **Medium** | 4.0 - 6.9 | Moderate risk | Fix within weeks |
| **Low** | 0.1 - 3.9 | Minor risk | Fix during maintenance |
| **Log** | 0.0 | Information only | Review for context |

### Detailed Vulnerability Information
```
For each finding:
- CVE identifier and CVSS score
- Detailed description and impact
- Affected hosts and services
- Proof of concept (where applicable)
- References and additional information
- Remediation recommendations
```

---

## üìã Reporting Features

### Report Formats
```bash
Available formats:
- HTML: Web-friendly detailed reports
- PDF: Executive and technical reports  
- XML: Machine-readable format
- CSV: Spreadsheet import format
- TXT: Plain text summary
- LaTeX: Publication-quality formatting
```

### Custom Report Generation
```
Reports ‚Üí New Report

Configuration options:
- Report format selection
- Content filtering (severity levels)
- Host selection and grouping
- Compliance mapping
- Executive summary inclusion
- Technical details level
```

### Report Scheduling
```
Configuration ‚Üí Alerts ‚Üí New Alert

Trigger conditions:
- Task completion
- Severity threshold reached
- New vulnerabilities detected
- Compliance status changes

Delivery methods:
- Email notifications
- SIEM integration
- Webhook callbacks
- File system export
```

---

## üîç Advanced Features

### Asset Management
```
Assets ‚Üí Hosts

Features:
- Host grouping and tagging
- Asset inventory tracking
- Change detection over time
- Relationship mapping
- Custom asset attributes
```

### Vulnerability Information (SecInfo)
```
SecInfo ‚Üí NVTs

Capabilities:
- Browse 50,000+ vulnerability tests
- Search by CVE, keyword, or family
- Review test descriptions and parameters
- Understand detection methodology
- Track vulnerability publication dates
```

### Compliance Scanning
```
Supported standards:
- PCI DSS (Payment Card Industry)
- NIST (National Institute of Standards)
- ISO 27001 (Information Security Management)
- BSI IT-Grundschutz (German IT Security)
- Custom compliance policies
```

---

## üõ†Ô∏è Integration Capabilities

### API Access
```bash
# GMP (Greenbone Management Protocol) API
curl -u admin:password \
  -X POST \
  https://localhost:9390/gmp \
  -d '<get_version/>'

# Python GVM Library
pip install python-gvm
```

### SIEM Integration
```python
# Example: Send results to SIEM
from gvm.connections import TLSConnection
from gvm.protocols.gmp import Gmp
from gvm.transforms import EtreeTransform

connection = TLSConnection(hostname='localhost')
transform = EtreeTransform()

with Gmp(connection, transform=transform) as gmp:
    gmp.authenticate('admin', 'password')
    reports = gmp.get_reports()
    # Process and send to SIEM
```

### Automation Scripts
```bash
#!/bin/bash
# Automated OpenVAS scanning script

# Start scan
TASK_ID=$(gvm-cli socket --xml='<create_task><name>Auto Scan</name><config id="daba56c8-73ec-11df-a475-002264764cea"/><target id="target-id"/></create_task>')

# Monitor progress
while [[ $(gvm-cli socket --xml="<get_tasks task_id='$TASK_ID'/>") != *"Done"* ]]; do
    sleep 60
done

# Generate report
gvm-cli socket --xml="<create_report><task id='$TASK_ID'/></create_report>"
```

---

## üéØ eJPT Exam Focus

### Key OpenVAS Skills for eJPT
1. **Installation and setup** of OpenVAS environment
2. **Target configuration** and credential management
3. **Scan execution** and progress monitoring
4. **Results interpretation** and risk assessment
5. **Report generation** and evidence documentation

### Common eJPT Scenarios
```
1. Network reconnaissance and vulnerability discovery
2. Web application security assessment
3. Configuration review and compliance checking
4. Credential-based authenticated scanning
5. Multi-host environment assessment
```

### Essential OpenVAS Workflow
```
1. Setup ‚Üí Install and configure OpenVAS
2. Targets ‚Üí Define IP ranges and credentials  
3. Scan ‚Üí Execute appropriate scan configuration
4. Analyze ‚Üí Review findings and severity levels
5. Report ‚Üí Generate documentation and evidence
```

---

## ‚ö†Ô∏è Common Issues and Solutions

### Installation Problems
```bash
# Database initialization issues
gvm-check-setup
sudo runuser -u _gvm -- gvmd --create-user=admin

# Feed synchronization problems  
greenbone-feed-sync
sudo -u _gvm greenbone-nvt-sync

# Service startup issues
systemctl status ospd-openvas
systemctl restart gvmd
```

### Performance Issues
```bash
# Memory optimization
# Edit /etc/default/greenbone-security-assistant
GSA_OPTIONS="--memory=512"

# Scanner optimization  
# Reduce concurrent checks in scan config
# Increase timeouts for slow networks
# Use discovery scan before full assessment
```

### Network Connectivity
```bash
# Firewall configuration
ufw allow 9392/tcp  # GSA web interface
ufw allow 9390/tcp  # GMP protocol

# SSL certificate issues
gvm-manage-certs -a -f
```

---

## üìä Vulnerability Management Workflow

### Vulnerability Lifecycle
```
1. Discovery ‚Üí Automated scanning identifies vulnerabilities
2. Validation ‚Üí Manual verification of findings
3. Assessment ‚Üí Risk analysis and business impact
4. Prioritization ‚Üí Ranking based on risk and exploitability  
5. Remediation ‚Üí Patching and configuration changes
6. Verification ‚Üí Re-scanning to confirm fixes
7. Reporting ‚Üí Documentation and stakeholder communication
```

### Continuous Monitoring Setup
```
Configuration approach:
1. Create scheduled recurring scans
2. Set up automated alerting for new vulnerabilities
3. Establish baseline security metrics
4. Implement change detection monitoring
5. Regular compliance assessment scheduling
```

### Metrics and KPIs
```
Vulnerability management metrics:
- Mean time to detection (MTTD)
- Mean time to remediation (MTTR)
- Vulnerability density per asset
- Risk exposure over time
- Patch compliance percentage
- False positive rates
```

---

## üîê Best Practices

### Security Considerations
- **Change default passwords** immediately after installation
- **Use HTTPS** for web interface access
- **Implement role-based access** for multi-user environments  
- **Secure credential storage** with encrypted databases
- **Regular updates** of vulnerability feeds
- **Network segmentation** for scanner deployment

### Scanning Strategy
- **Start with discovery scans** to map the environment
- **Use authenticated scans** where credentials are available
- **Schedule regular scans** for continuous monitoring
- **Customize scan configs** based on target environment
- **Validate critical findings** manually before reporting

### Performance Optimization
- **Tune scanner settings** based on network capacity
- **Use distributed scanning** for large environments  
- **Implement scan scheduling** to avoid business hour impact
- **Monitor resource utilization** during scans
- **Archive old scan results** to manage database size

---

## üìà Enterprise Deployment

### Distributed Scanning Architecture
```
Central Manager (GVM):
- Centralized management interface
- Report aggregation and analysis
- User authentication and authorization
- Policy and configuration management

Remote Scanners (OSP):
- Distributed scan execution
- Network-specific vulnerability testing
- Encrypted communication to central manager
- Local credential and configuration storage
```

### High Availability Setup
```bash
# Database clustering for redundancy
postgresql-cluster-setup

# Load balancing for web interface
nginx-load-balancer-config

# Backup and recovery procedures
gvm-backup-script
```

This comprehensive OpenVAS guide covers all aspects needed for effective vulnerability assessment, from basic setup to enterprise deployment, with specific focus on eJPT exam requirements and practical implementation scenarios.
