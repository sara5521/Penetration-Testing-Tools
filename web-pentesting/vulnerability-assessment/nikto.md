# ðŸ” Nikto - Web Vulnerability Scanner

Comprehensive guide to using Nikto for web server and application vulnerability scanning.

**Location in Framework:** `web-pentesting/vulnerability-assessment/nikto.md`

---

## ðŸŽ¯ What is Nikto?

Nikto is an open source web server scanner that performs comprehensive tests against web servers for multiple items including:
- **Dangerous files and programs** 
- **Outdated server versions** and software
- **Server configuration issues**
- **Default files and scripts**
- **Insecure HTTP methods**

---

## ðŸ“¦ Installation and Setup

### Kali Linux Installation
```bash
# Nikto comes pre-installed in Kali Linux
nikto -Version

# Manual installation if needed
apt-get update
apt-get install nikto
```

### Update Nikto Database
```bash
# Update vulnerability databases
nikto -update

# Check current version and database
nikto -Version
```

---

## ðŸ”§ Basic Usage and Syntax

### Basic Scan Commands
```bash
# Basic web server scan
nikto -h http://target.com

# Scan specific port
nikto -h http://target.com -p 8080

# Scan multiple ports
nikto -h http://target.com -p 80,443,8080,8443

# HTTPS scanning
nikto -h https://target.com
```

### Advanced Scanning Options
```bash
# Scan with specific tuning options
nikto -h http://target.com -Tuning 123456789

# Scan with authentication
nikto -h http://target.com -id userid:password

# Scan through proxy
nikto -h http://target.com -useproxy http://proxy:8080

# Save results to file
nikto -h http://target.com -o results.txt
```

---

## âš™ï¸ Command Line Options

### Essential Parameters
| Parameter | Description | Example |
|-----------|-------------|---------|
| `-h` | Target host | `-h http://target.com` |
| `-p` | Port(s) to scan | `-p 80,443,8080` |
| `-ssl` | Force SSL/TLS | `-ssl` |
| `-id` | Authentication credentials | `-id user:pass` |
| `-o` | Output file | `-o results.txt` |
| `-Format` | Output format | `-Format html` |

### Tuning Options (-Tuning)
```bash
# Tuning categories (combine numbers)
1 = Interesting File / Seen in logs
2 = Misconfiguration / Default File  
3 = Information Disclosure
4 = Injection (XSS/Script/HTML)
5 = Remote File Retrieval - Inside Web Root
6 = Denial of Service
7 = Remote File Retrieval - Server Wide
8 = Command Execution - Remote Shell
9 = SQL Injection
0 = File Upload
a = Authentication Bypass
b = Software Identification
c = Remote Source Inclusion

# Example: Test for XSS, SQL injection, and file upload
nikto -h http://target.com -Tuning 490
```

---

## ðŸ§ª Practical Scanning Examples

### Basic Web Server Assessment
```bash
# Comprehensive scan with common options
nikto -h http://192.168.1.100 -p 80,443 -ssl -o nikto_scan.txt

# Scan with verbose output
nikto -h http://target.com -Display V

# Fast scan (reduced checks)
nikto -h http://target.com -Fast
```

### Targeted Vulnerability Scanning
```bash
# Focus on dangerous files and configurations
nikto -h http://target.com -Tuning 12

# Test for injection vulnerabilities
nikto -h http://target.com -Tuning 49

# Authentication and access control testing
nikto -h http://target.com -Tuning a
```

### Authenticated Scanning
```bash
# Basic authentication
nikto -h http://target.com -id admin:password

# Custom headers for authentication
nikto -h http://target.com -H "Authorization: Bearer token123"

# Cookie-based authentication
nikto -h http://target.com -H "Cookie: session=abc123"
```

---

## ðŸ“Š Understanding Nikto Output

### Output Format Examples

#### Standard Output
```
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.1.100
+ Target Hostname:    target.com
+ Target Port:        80
+ Start Time:         2024-01-15 10:30:00 (GMT0)
---------------------------------------------------------------------------
+ Server: Apache/2.4.41 (Ubuntu)
+ Cookie PHPSESSID created without the httponly flag
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined.
+ Uncommon header 'x-powered-by' found, with contents: PHP/7.4.3
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Entry '/admin/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ "robots.txt" contains 2 entries which should be manually viewed.
+ Apache/2.4.41 appears to be outdated (current is at least Apache/2.4.54).
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
+ /config.php: PHP Config file may contain database IDs and passwords.
+ /phpmyadmin/: phpMyAdmin directory found
+ /backup/: Backup directory found
+ 7915 requests: 0 error(s) and 12 item(s) reported on remote host
```

### Finding Categories
- **Server Information** - Version, headers, configuration
- **Security Headers** - Missing security headers
- **Dangerous Files** - Config files, backups, admin panels
- **Default Content** - Default installations, sample files
- **Vulnerabilities** - Known CVEs, misconfigurations

---

## ðŸ” Advanced Nikto Features

### Plugin Management
```bash
# List available plugins
nikto -list-plugins

# Run specific plugins only  
nikto -h http://target.com -Plugins "apache_expect_xss,cookies"

# Exclude specific plugins
nikto -h http://target.com -Plugins "@@DEFAULT;!outdated"
```

### Custom Scanning Configurations
```bash
# Custom user agent
nikto -h http://target.com -useragent "Custom Scanner 1.0"

# Custom timeout settings
nikto -h http://target.com -timeout 10

# Limit requests per second
nikto -h http://target.com -Pause 2
```

### Database and Signature Management
```bash
# Update signature databases
nikto -update

# Use specific database file
nikto -h http://target.com -dbcheck

# Display database information
nikto -Version
```

---

## ðŸ“‹ Output Formats and Reporting

### Export Options
```bash
# HTML report
nikto -h http://target.com -Format html -o report.html

# XML format for tool integration
nikto -h http://target.com -Format xml -o results.xml

# CSV format for spreadsheet analysis
nikto -h http://target.com -Format csv -o findings.csv

# Multiple formats simultaneously
nikto -h http://target.com -Format htm -o report.html -Format xml -o results.xml
```

### Custom Report Templates
```bash
# Create detailed HTML report with all findings
nikto -h http://target.com -Format html -Display 1234EP -o detailed_report.html

# Display options:
# 1 = Show redirects
# 2 = Show cookies received  
# 3 = Show all 200/OK responses
# 4 = Show URLs which require authentication
# E = Show errors
# P = Show progress
# V = Verbose output
```

---

## ðŸ›¡ï¸ Evasion and Stealth Techniques

### IDS/IPS Evasion
```bash
# Random user agents
nikto -h http://target.com -useragent "Mozilla/5.0 (compatible; Googlebot/2.1)"

# Slow scanning to avoid detection
nikto -h http://target.com -Pause 5

# Use proxy chains for anonymity
nikto -h http://target.com -useproxy http://proxy1:8080

# Custom HTTP methods
nikto -h http://target.com -mutate 1234
```

### Mutation Options (-mutate)
```bash
# Mutation techniques:
1 = Test all files with all root directories
2 = Guess for password file names
3 = Enumerate user names via Apache (/~user type requests)
4 = Enumerate user names via cgiwrap (/cgi-bin/cgiwrap/~user type requests)
5 = Attempt to brute force sub-domain names
6 = Attempt to guess directory names from dictionary file
```

---

## ðŸŽ¯ Integration with Penetration Testing

### Nikto in Reconnaissance Phase
```bash
# Initial web server assessment
nmap -p 80,443 target.com
nikto -h http://target.com -p 80,443

# Technology stack identification
nikto -h http://target.com -Tuning b
```

### Integration with Other Tools
```bash
# Combine with Nmap results
nmap -p- target.com -oG ports.gnmap
nikto -h target.com -p $(grep "80/open\|443/open\|8080/open" ports.gnmap | cut -d' ' -f2)

# Follow up with directory bruteforcing
nikto -h http://target.com
gobuster dir -u http://target.com -w /usr/share/wordlists/dirb/common.txt

# Feed results to Burp Suite for manual testing
nikto -h http://target.com -o nikto_findings.txt
# Import findings into Burp for manual verification
```

---

## âš ï¸ Common Issues and Troubleshooting

### SSL/TLS Issues
```bash
# Force SSL scanning
nikto -h https://target.com -ssl

# Ignore SSL certificate errors
nikto -h https://target.com -ssl -nointeractive

# Custom SSL port
nikto -h target.com -p 8443 -ssl
```

### Authentication Problems
```bash
# Test different authentication methods
nikto -h http://target.com -id "user:pass"
nikto -h http://target.com -H "Authorization: Basic dXNlcjpwYXNz"
nikto -h http://target.com -H "Cookie: auth=token123"
```

### Performance Issues
```bash
# Reduce scan intensity
nikto -h http://target.com -Fast

# Increase timeout for slow servers
nikto -h http://target.com -timeout 30

# Reduce concurrent connections
nikto -h http://target.com -Pause 3
```

### Network Connectivity Issues
```bash
# Test connectivity first
ping target.com
telnet target.com 80

# Use different HTTP methods
nikto -h http://target.com -mutate 1

# Check for proxy issues
nikto -h http://target.com -noproxy
```

---

## ðŸŽ¯ eJPT Exam Focus

### Key Nikto Skills for eJPT
1. **Basic scanning** of web servers and applications
2. **Output interpretation** and finding prioritization
3. **Integration** with other reconnaissance tools
4. **Authentication testing** with credentials
5. **Report generation** and evidence collection

### Common eJPT Scenarios
```bash
# Initial web server assessment
nikto -h http://target.com

# Focused vulnerability scanning
nikto -h http://target.com -Tuning 1234

# Authenticated scanning
nikto -h http://target.com -id admin:password

# Multiple port scanning
nikto -h http://target.com -p 80,443,8080
```

### Essential Commands for Exam
```bash
# Quick comprehensive scan
nikto -h target.com -o results.txt

# SSL-enabled server scanning
nikto -h https://target.com -ssl

# Results in HTML format
nikto -h target.com -Format html -o report.html

# Tuned scanning for specific vulnerabilities
nikto -h target.com -Tuning 49
```

---

## ðŸ“Š Finding Analysis and Remediation

### Critical Findings
- **Default credentials** - Change immediately
- **Outdated software** - Update to latest versions
- **Configuration files exposed** - Restrict access
- **Administrative interfaces** - Secure or remove
- **Directory traversal** - Input validation

### Information Disclosure Issues
- **Server version disclosure** - Configure server to hide version
- **Technology stack exposure** - Remove identifying headers
- **Error message leakage** - Implement custom error pages
- **Backup file exposure** - Remove from web directory

### Security Header Issues
```http
# Missing security headers identified by Nikto
X-Frame-Options: DENY
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Strict-Transport-Security: max-age=31536000
Content-Security-Policy: default-src 'self'
```

---

## ðŸ”§ Nikto Configuration Files

### Custom Database Files
```bash
# Location of Nikto databases
/usr/share/nikto/databases/

# Custom scan database
/usr/share/nikto/databases/db_tests_custom

# Plugin directory
/usr/share/nikto/plugins/
```

### Configuration File
```bash
# Main configuration file
/etc/nikto.conf

# User-specific configuration
~/.nikto.conf

# Example configuration options
CLIOPTS=-Display 123EP
PROXYHOST=127.0.0.1
PROXYPORT=8080
USERAGENT=Nikto Scanner 2.5.0
```

---

## ðŸš€ Advanced Nikto Techniques

### Custom Plugin Development
```perl
# Example Nikto plugin structure
sub nikto_custom_init {
    my ($mark) = @_;
    $mark->{'nikto_custom'} = {
        'name' => 'Custom Test',
        'ident' => 'custom_test',
        'message' => 'Custom vulnerability test',
        'uri' => '/custom/test',
        'method' => 'GET'
    };
}
```

### Scripted Nikto Usage
```bash
#!/bin/bash
# Automated Nikto scanning script

# Read targets from file
while read -r target; do
    echo "Scanning: $target"
    nikto -h "$target" -Format html -o "nikto_${target//[.\/]/_}.html"
    sleep 5  # Rate limiting
done < targets.txt

echo "All scans completed"
```

### Integration with CI/CD
```yaml
# Example GitLab CI integration
nikto_scan:
  stage: security
  script:
    - nikto -h $TARGET_URL -Format xml -o nikto_results.xml
  artifacts:
    reports:
      junit: nikto_results.xml
```

---

## ðŸ“‹ Best Practices

### Scanning Strategy
1. **Start with basic scan** to identify server type and basic issues
2. **Use targeted tuning** based on initial findings
3. **Authenticate when possible** for comprehensive coverage
4. **Document all findings** with appropriate risk ratings
5. **Verify findings manually** to eliminate false positives

### False Positive Management
- **Custom software** may trigger false alerts
- **Modified server headers** can cause confusion
- **Proxies and load balancers** may interfere with results
- **Always verify** critical findings manually

### Performance Optimization
```bash
# Optimize for different scenarios

# Fast initial assessment
nikto -h target.com -Fast -Tuning b

# Comprehensive security scan
nikto -h target.com -Tuning 123456789 -timeout 30

# Stealth scanning
nikto -h target.com -Pause 5 -useragent "Mozilla/5.0..."
```

---

## ðŸ”— Tool Integration

### With Nmap
```bash
# Discover web servers then scan with Nikto
nmap -p 80,443,8080,8443 --open target_network/24 -oG web_servers.gnmap
grep "open" web_servers.gnmap | awk '{print $2}' | while read host; do
    nikto -h $host -p 80,443,8080,8443
done
```

### With Metasploit
```bash
# Use Nikto findings in Metasploit
msfconsole
msf6 > use auxiliary/scanner/http/nikto
msf6 auxiliary(scanner/http/nikto) > set RHOSTS target.com
msf6 auxiliary(scanner/http/nikto) > run
```

### With Burp Suite
```bash
# Generate target list for Burp Suite
nikto -h target.com -o findings.txt
# Parse findings and add interesting URLs to Burp target scope
```

---

## ðŸ“ˆ Reporting and Documentation

### Executive Summary Template
```markdown
## Web Server Security Assessment - Nikto Scan Results

**Target:** target.com
**Scan Date:** [Date]
**Scanner:** Nikto v2.5.0

### Summary
- **Total Issues Found:** 15
- **Critical:** 2
- **High:** 5  
- **Medium:** 6
- **Low:** 2

### Key Findings
1. Outdated Apache server version detected
2. Default phpMyAdmin installation found
3. Missing security headers
4. Exposed configuration files
5. Directory listing enabled
```

### Technical Details Format
```markdown
### Finding: Exposed Configuration File

**Severity:** High
**URL:** http://target.com/config.php
**Description:** Configuration file accessible via web browser
**Risk:** Database credentials and sensitive information exposure
**Recommendation:** Remove file from web directory or restrict access

**Evidence:**
```
GET /config.php HTTP/1.1
Host: target.com

HTTP/1.1 200 OK
Content-Type: text/plain

<?php
$db_user = "admin";
$db_pass = "secret123";
?>
```
```
